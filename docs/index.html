
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>University Comparison Tool</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    label { font-weight: bold; display: block; margin-top: 20px; }
    input[type="text"] { width: 100%; padding: 5px; margin: 10px 0; }
    .checkbox-list { max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 5px; }
    .checkbox-item { display: flex; align-items: center; margin-bottom: 4px; }
    .checkbox-item input[type="checkbox"] { margin-right: 8px; }
  </style>
</head>
<body>

<h2>ðŸŽ“ Custom University Comparison Tool</h2>
<p><em>All values are projected for the year 2028 using the Holt-Winters Forecasting Model.</em></p>

<details>
  <summary><strong>ðŸ“˜ Metric Definitions (click to expand)</strong></summary>
  <div style="margin-top: 10px; line-height: 1.6; font-size: 15px;">
    <p><strong>University:</strong> Name of the institution.</p>
    <p><strong>City / State:</strong> Geographic location of the institution.</p>
    <p><strong>Religion:</strong> Religious affiliation, if applicable.</p>
    <p><strong>FTFT:</strong> Projected first-time, full-time students.</p>
    <p><strong>Graduation Rate:</strong> Projected 2028 percentile graduation rate.</p>
    <p><strong>Collegiate Survivability Index:</strong> Percentile indicating long-term viability.</p>
  </div>
</details>

<label for="searchInput">Search Universities:</label>
<input type="text" id="searchInput" placeholder="Type to search...">
<div id="universityCheckboxes" class="checkbox-list"></div>

<label>Select up to 5 Metrics:</label>
<div id="metricCheckboxes" class="checkbox-list"></div>

<button onclick="generateCustomTable()">Generate Comparison Table</button>

<table id="comparison-table"></table>

<script>
  const maxUniversities = 8;
  const maxMetrics = 5;

  const allMetrics = [
    'City', 'State', 'Religion', 'Universities in State', 'FTFT',
    'Graduation Rate', 'Degrees Awarded', 'FTE Faculty', 'FTE Students',
    'Average Course Size', 'Degrees per Faculty', 'Net Assets', 'Total Assets',
    'Net Income', 'Total Revenue', 'Instructional Expenses',
    'Collegiate Survivability Index', 'Rank'
  ];

  let allData = [];

  function formatValue(metric, value) {
    if (metric === 'Collegiate Survivability Index' || metric === 'Graduation Rate') {
      return (parseFloat(value) * 100).toFixed(2) + '%';
    } else if (metric.includes('Assets') || metric.includes('Revenue') || metric.includes('Income') || metric.includes('Expenses')) {
      return '$' + parseFloat(value).toLocaleString(undefined, { maximumFractionDigits: 0 });
    } else {
      return value;
    }
  }

  function populateSelectors(data) {
    const universitySet = new Set(data.map(d => d.University));
    const universitySelect = document.getElementById('universityCheckboxes');
    const metricSelect = document.getElementById('metricCheckboxes');

    universitySet.forEach(uni => {
      const div = document.createElement('div');
      div.className = 'checkbox-item';
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.value = uni;
      checkbox.name = 'university';
      const label = document.createElement('label');
      label.textContent = uni;
      div.appendChild(checkbox);
      div.appendChild(label);
      universitySelect.appendChild(div);
    });

    allMetrics.forEach(metric => {
      const div = document.createElement('div');
      div.className = 'checkbox-item';
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.value = metric;
      checkbox.name = 'metric';
      const label = document.createElement('label');
      label.textContent = metric;
      div.appendChild(checkbox);
      div.appendChild(label);
      metricSelect.appendChild(div);
    });

    document.getElementById('searchInput').addEventListener('input', function() {
      const search = this.value.toLowerCase();
      const checkboxes = universitySelect.querySelectorAll('.checkbox-item');
      checkboxes.forEach(div => {
        const label = div.textContent.toLowerCase();
        div.style.display = label.includes(search) ? 'flex' : 'none';
      });
    });
  }

  function generateCustomTable() {
    const selectedUniversities = Array.from(document.querySelectorAll('input[name="university"]:checked')).map(cb => cb.value);
    const selectedMetrics = Array.from(document.querySelectorAll('input[name="metric"]:checked')).map(cb => cb.value);

    if (selectedUniversities.length === 0 || selectedMetrics.length === 0) {
      alert("Please select at least one university and one metric.");
      return;
    }
    if (selectedUniversities.length > maxUniversities) {
      alert("Please select no more than " + maxUniversities + " universities.");
      return;
    }
    if (selectedMetrics.length > maxMetrics) {
      alert("Please select no more than " + maxMetrics + " metrics.");
      return;
    }

    const table = document.getElementById('comparison-table');
    table.innerHTML = '';

    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    const thBlank = document.createElement('th');
    thBlank.textContent = 'University';
    headerRow.appendChild(thBlank);

    selectedMetrics.forEach(metric => {
      const th = document.createElement('th');
      th.textContent = metric;
      headerRow.appendChild(th);
    });

    const tbody = table.createTBody();
    allData.forEach(entry => {
      if (selectedUniversities.includes(entry.University)) {
        const row = tbody.insertRow();
        const uniCell = row.insertCell();
        uniCell.textContent = entry.University;

        selectedMetrics.forEach(metric => {
          const cell = row.insertCell();
          cell.textContent = formatValue(metric, entry[metric]);
        });
      }
    });
  }

  fetch('university_data_tier1.json')
    .then(response => response.json())
    .then(data => {
      allData = data;
      populateSelectors(data);
    });
</script>

</body>
</html>
