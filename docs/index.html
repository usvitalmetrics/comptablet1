
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>University Comparison Tool</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    select { margin: 10px 0; padding: 5px; width: 100%; }
    label { font-weight: bold; display: block; margin-top: 20px; }
    details { margin: 20px 0; }
  </style>
</head>
<body>

<h2>ðŸŽ“ Custom University Comparison Tool</h2>

<details>
  <summary><strong>ðŸ“˜ Metric Definitions (click to expand)</strong></summary>
  <div style="margin-top: 10px; line-height: 1.6; font-size: 15px;">
    <p><strong>University:</strong> Name of the institution.</p>
    <p><strong>City / State:</strong> Geographic location of the institution.</p>
    <p><strong>Religion:</strong> Religious affiliation, if applicable.</p>
    <p><strong>FTFT:</strong> Projected 2028 first-time, full-time students.</p>
    <p><strong>FTE Faculty / Students:</strong> Full-time equivalent faculty or students.</p>
    <p><strong>Graduation Rate:</strong> Projected graduation percentage.</p>
    <p><strong>Degrees per Faculty:</strong> Degrees awarded divided by number of FTE faculty.</p>
    <p><strong>Net/Total Assets, Revenue, Income, Instructional Expenses:</strong> Financial metrics projected for 2028, in USD.</p>
    <p><strong>Collegiate Survivability Index:</strong> Projected institutional health percentile.</p>
    <p><strong>Rank:</strong> National comparative ranking.</p>
  </div>
</details>

<label for="universitySelect">Select up to 8 Universities:</label>
<select id="universitySelect" multiple size="10"></select>

<label for="metricSelect">Select up to 5 Metrics:</label>
<select id="metricSelect" multiple size="10"></select>

<button onclick="generateCustomTable()">Generate Comparison Table</button>

<table id="comparison-table"></table>

<script>
  const maxUniversities = 8;
  const maxMetrics = 5;

  const allMetrics = [
    'City',
    'State',
    'Religion',
    'Universities in State',
    'FTFT',
    'Graduation Rate',
    'Degrees Awarded',
    'FTE Faculty',
    'FTE Students',
    'Average Course Size',
    'Degrees per Faculty',
    'Net Assets',
    'Total Assets',
    'Net Income',
    'Total Revenue',
    'Instructional Expenses',
    'Collegiate Survivability Index',
    'Rank'
  ];

  let allData = [];

  function formatValue(metric, value) {
    if (metric.includes('Rate') || metric.includes('Index')) {
      return parseFloat(value).toFixed(1) + '%';
    } else if (metric.includes('Assets') || metric.includes('Revenue') || metric.includes('Income') || metric.includes('Expenses')) {
      return '$' + parseFloat(value).toLocaleString();
    } else {
      return value;
    }
  }

  function populateSelectors(data) {
    const universitySet = new Set(data.map(d => d.University));
    const universitySelect = document.getElementById('universitySelect');
    const metricSelect = document.getElementById('metricSelect');

    universitySet.forEach(uni => {
      const opt = document.createElement('option');
      opt.value = uni;
      opt.textContent = uni;
      universitySelect.appendChild(opt);
    });

    allMetrics.forEach(metric => {
      const opt = document.createElement('option');
      opt.value = metric;
      opt.textContent = metric;
      metricSelect.appendChild(opt);
    });
  }

  function generateCustomTable() {
    const selectedUniversities = Array.from(document.getElementById('universitySelect').selectedOptions).map(o => o.value);
    const selectedMetrics = Array.from(document.getElementById('metricSelect').selectedOptions).map(o => o.value);

    if (selectedUniversities.length === 0 || selectedMetrics.length === 0) {
      alert("Please select at least one university and one metric.");
      return;
    }
    if (selectedUniversities.length > maxUniversities) {
      alert("Please select no more than " + maxUniversities + " universities.");
      return;
    }
    if (selectedMetrics.length > maxMetrics) {
      alert("Please select no more than " + maxMetrics + " metrics.");
      return;
    }

    const table = document.getElementById('comparison-table');
    table.innerHTML = '';

    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    const thBlank = document.createElement('th');
    thBlank.textContent = 'University';
    headerRow.appendChild(thBlank);

    selectedMetrics.forEach(metric => {
      const th = document.createElement('th');
      th.textContent = metric;
      headerRow.appendChild(th);
    });

    const tbody = table.createTBody();
    allData.forEach(entry => {
      if (selectedUniversities.includes(entry.University)) {
        const row = tbody.insertRow();
        const uniCell = row.insertCell();
        uniCell.textContent = entry.University;

        selectedMetrics.forEach(metric => {
          const cell = row.insertCell();
          cell.textContent = formatValue(metric, entry[metric]);
        });
      }
    });
  }

  fetch('university_data_tier1.json')
    .then(response => response.json())
    .then(data => {
      allData = data;
      populateSelectors(data);
    });
</script>

</body>
</html>
