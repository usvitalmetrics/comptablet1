
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>University Comparison Tool</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    label { font-weight: bold; display: block; margin-top: 20px; }
    input[type="text"] { width: 100%; padding: 5px; margin: 10px 0; }

    .selectable-list { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 10px; }
    .tag {
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      padding: 5px 10px;
      border-radius: 20px;
      cursor: pointer;
      user-select: none;
    }
    .tag.selected {
      background-color: #007BFF;
      color: white;
      border-color: #0056b3;
    }

    details { margin: 20px 0; }
  </style>
</head>
<body>

<h2>ðŸŽ“ Custom University Comparison Tool</h2>
<p><em>All values are projected for the year 2028 using the Holt-Winters Forecasting Model.</em></p>

<details>
  <summary><strong>ðŸ“˜ Metric Definitions (click to expand)</strong></summary>
  <div style="margin-top: 10px; line-height: 1.6; font-size: 15px;">
    <p><strong>University:</strong> Name of the institution.</p>
    <p><strong>City / State:</strong> Geographic location of the institution.</p>
    <p><strong>Religion:</strong> Religious affiliation, if applicable.</p>
    <p><strong>Universities in State:</strong> Number of universities in the same state.</p>
    <p><strong>FTFT:</strong> First-time, full-time undergraduate students.</p>
    <p><strong>Graduation Rate:</strong> Percent of students projected to graduate.</p>
    <p><strong>Degrees Awarded:</strong> Total number of degrees expected to be awarded.</p>
    <p><strong>FTE Faculty / Students:</strong> Full-time equivalent faculty or student headcount.</p>
    <p><strong>Average Course Size:</strong> Average number of students per course section.</p>
    <p><strong>Degrees per Faculty:</strong> Ratio of degrees awarded to faculty FTE.</p>
    <p><strong>Net Assets:</strong> Total assets minus liabilities.</p>
    <p><strong>Total Assets:</strong> All assets held by the institution.</p>
    <p><strong>Net Income:</strong> Total revenue minus expenses.</p>
    <p><strong>Total Revenue:</strong> Sum of all revenue sources.</p>
    <p><strong>Instructional Expenses:</strong> Spending on instructional programs.</p>
    <p><strong>Collegiate Survivability Index:</strong> Relative institutional stability (higher is better).</p>
    <p><strong>Rank:</strong> National rank of viability out of all private nonprofit universities.</p>
  </div>
</details>

<label for="searchInput">Search Universities:</label>
<input type="text" id="searchInput" placeholder="Type to search...">
<div id="universityTags" class="selectable-list"></div>

<label>Select up to 5 Metrics:</label>
<div id="metricTags" class="selectable-list"></div>

<button onclick="generateCustomTable()">Generate Comparison Table</button>

<table id="comparison-table"></table>

<script>
  const maxUniversities = 8;
  const maxMetrics = 5;

  const allMetrics = [
    'City', 'State', 'Religion', 'Universities in State', 'FTFT',
    'Graduation Rate', 'Degrees Awarded', 'FTE Faculty', 'FTE Students',
    'Average Course Size', 'Degrees per Faculty', 'Net Assets', 'Total Assets',
    'Net Income', 'Total Revenue', 'Instructional Expenses',
    'Collegiate Survivability Index', 'Rank'
  ];

  let allData = [];

  function formatValue(metric, value) {
    if (metric === 'Collegiate Survivability Index' || metric === 'Graduation Rate') {
      return (parseFloat(value) * 100).toFixed(2) + '%';
    } else if (metric.includes('Assets') || metric.includes('Revenue') || metric.includes('Income') || metric.includes('Expenses')) {
      return '$' + parseFloat(value).toLocaleString(undefined, { maximumFractionDigits: 0 });
    } else {
      return value;
    }
  }

  function toggleSelection(tag, list, maxAllowed) {
    if (tag.classList.contains('selected')) {
      tag.classList.remove('selected');
    } else {
      const selectedCount = list.querySelectorAll('.selected').length;
      if (selectedCount >= maxAllowed) {
        alert("Maximum selection limit reached.");
        return;
      }
      tag.classList.add('selected');
    }
  }

  function populateTags(data) {
    const universitySet = new Set(data.map(d => d.University));
    const universityContainer = document.getElementById('universityTags');
    const metricContainer = document.getElementById('metricTags');

    universitySet.forEach(uni => {
      const tag = document.createElement('div');
      tag.className = 'tag';
      tag.textContent = uni;
      tag.dataset.value = uni;
      tag.addEventListener('click', () => toggleSelection(tag, universityContainer, maxUniversities));
      universityContainer.appendChild(tag);
    });

    allMetrics.forEach(metric => {
      const tag = document.createElement('div');
      tag.className = 'tag';
      tag.textContent = metric;
      tag.dataset.value = metric;
      tag.addEventListener('click', () => toggleSelection(tag, metricContainer, maxMetrics));
      metricContainer.appendChild(tag);
    });

    document.getElementById('searchInput').addEventListener('input', function() {
      const search = this.value.toLowerCase();
      universityContainer.querySelectorAll('.tag').forEach(tag => {
        tag.style.display = tag.textContent.toLowerCase().includes(search) ? 'inline-block' : 'none';
      });
    });
  }

  function generateCustomTable() {
    const selectedUniversities = Array.from(document.querySelectorAll('#universityTags .selected')).map(tag => tag.dataset.value);
    const selectedMetrics = Array.from(document.querySelectorAll('#metricTags .selected')).map(tag => tag.dataset.value);

    if (selectedUniversities.length === 0 || selectedMetrics.length === 0) {
      alert("Please select at least one university and one metric.");
      return;
    }

    const table = document.getElementById('comparison-table');
    table.innerHTML = '';

    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    const thBlank = document.createElement('th');
    thBlank.textContent = 'University';
    headerRow.appendChild(thBlank);

    selectedMetrics.forEach(metric => {
      const th = document.createElement('th');
      th.textContent = metric;
      headerRow.appendChild(th);
    });

    const tbody = table.createTBody();
    allData.forEach(entry => {
      if (selectedUniversities.includes(entry.University)) {
        const row = tbody.insertRow();
        const uniCell = row.insertCell();
        uniCell.textContent = entry.University;

        selectedMetrics.forEach(metric => {
          const cell = row.insertCell();
          cell.textContent = formatValue(metric, entry[metric]);
        });
      }
    });
  }

  fetch('university_data_tier1.json')
    .then(response => response.json())
    .then(data => {
      allData = data;
      populateTags(data);
    });
</script>

</body>
</html>
